<?xml version="1.0" encoding="UTF-8" standalone="yes"?>

<aut:automator
	xmlns:aut="http://dsg.ce.unipr.it/software/deus/schema/automator"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://dsg.ce.unipr.it/software/deus/schema/automator ../../schema/automator.xsd ">
	
    <aut:event handler="it.unipr.ce.dsg.deus.example.d2v.D2VDiscoveryEvent" id="Discovery">
        <aut:params>
            <aut:param value="TRUE" name="hasSameAssociatedNode"/>
        </aut:params>
    </aut:event>
    <aut:event schedulerListener="it.unipr.ce.dsg.deus.example.d2v.D2VTrafficElementBirthScheduler" handler="it.unipr.ce.dsg.deus.example.d2v.D2VTrafficElementBirthEvent" id="TrafficEventBirth"/>
    <aut:event oneShot="true" handler="it.unipr.ce.dsg.deus.example.d2v.D2VPeerMovementEvent" id="PeerMovement"/>
    <aut:event handler="it.unipr.ce.dsg.deus.example.d2v.D2VLogNodeMapEvent" id="LogMapEvent"/>
    <aut:event handler="it.unipr.ce.dsg.deus.example.d2v.D2VLogNodesStatsEvent" id="LogStatEvent"/>
    <aut:event schedulerListener="it.unipr.ce.dsg.deus.example.d2v.D2VBirthSchedulerListener" handler="it.unipr.ce.dsg.deus.example.d2v.D2VBirthEvent" id="Birth">
        <aut:events>
            <aut:reference id="FirstDiscovery"/>
        </aut:events>
    </aut:event>
    <aut:event oneShot="true" schedulerListener="it.unipr.ce.dsg.deus.example.d2v.D2VFirstDiscoverySchedulerListener" handler="it.unipr.ce.dsg.deus.example.d2v.D2VFirstDiscoveryEvent" id="FirstDiscovery">
        <aut:params>
            <aut:param value="20" name="peerListLimit"/>
        </aut:params>
        <aut:events>
            <aut:reference id="PeerMovement"/>
            <aut:reference id="Discovery"/>
        </aut:events>
    </aut:event>
    <aut:event oneShot="true" handler="it.unipr.ce.dsg.deus.example.d2v.D2VConfigurationEvent" id="Configuration">
    </aut:event>
    <aut:node handler="it.unipr.ce.dsg.deus.example.d2v.D2VTrafficElement" id="TrafficElement">
        <aut:params>
            <aut:param value="1000.0" name="period"/>
            <aut:param value="1000.0" name="jamPeriod"/>
            <aut:param value="roadWok" name="type"/>
        </aut:params>
    </aut:node>
    <aut:node handler="it.unipr.ce.dsg.deus.example.d2v.D2VPeer" id="D2VPeer">
        <aut:params>
            <aut:param value="3.0" name="alpha"/>
            <aut:param value="5" name="k"/>
            <aut:param value="40" name="bucketNodeLimit"/>
            <aut:param value="0.5" name="radiusKm"/>
            <aut:param value="0.1" name="epsilon"/>
            <aut:param value="30.0" name="avgSpeedMax"/>
            <aut:param value="10.0" name="carMinSpeed"/>
            <aut:param value="25.0" name="discoveryMinPeriod"/>
            <aut:param value="100.0" name="discoveryMaxPeriod"/>
            <aut:param value="25" name="discoveryPeriodPeerLimit"/>
            <aut:param value="200" name="discoveryMaxPeerNumber"/>
            <aut:param value="1.0" name="isContentDistributionActive"/>
            <aut:param value="1000.0" name="ttlValue"/>
            <aut:param value="2.0" name="rangeValue"/>
        </aut:params>
    </aut:node>
    <aut:process handler="it.unipr.ce.dsg.deus.impl.process.PeriodicProcess" id="PeriodicDiscovery">
        <aut:params>
            <aut:param value="5" name="period"/>
        </aut:params>
        <aut:events>
            <aut:reference id="Discovery"/>
        </aut:events>
    </aut:process>
    
    <aut:process handler="it.unipr.ce.dsg.deus.impl.process.PoissonProcess" id="TrafficEventBirthPoissonProcess">
        <aut:params>
            <aut:param value="2000" name="meanArrival"/>
        </aut:params>
        <aut:nodes>
            <aut:reference id="TrafficElement"/>
        </aut:nodes>
        <aut:events>
            <aut:reference id="TrafficEventBirth"/>
        </aut:events>
    </aut:process>
    
    <aut:process handler="it.unipr.ce.dsg.deus.impl.process.PeriodicProcess" id="LogStatPeriodicProcess">
        <aut:params>
            <aut:param value="100" name="period"/>
        </aut:params>
        <aut:events>
            <aut:reference id="LogStatEvent"/>
        </aut:events>
    </aut:process>
    <aut:process handler="it.unipr.ce.dsg.deus.impl.process.PeriodicProcess" id="LogMaPeriodicProcess">
        <aut:params>
            <aut:param value="2" name="period"/>
        </aut:params>
        <aut:events>
            <aut:reference id="LogMapEvent"/>
        </aut:events>
    </aut:process>
    <aut:process handler="it.unipr.ce.dsg.deus.impl.process.RectangularPulsePeriodicProcess" id="RectangularBirth">
        <aut:params>
            <aut:param value="25" name="period"/>
            <aut:param value="0" name="startVtThreshold"/>
            <aut:param value="5000" name="stopVtThreshold"/>
        </aut:params>
        <aut:nodes>
            <aut:reference id="D2VPeer"/>
        </aut:nodes>
        <aut:events>
            <aut:reference id="Birth"/>
        </aut:events>
    </aut:process>
    <aut:process handler="it.unipr.ce.dsg.deus.impl.process.PoissonProcess" id="ConfigurationProcess">
        <aut:params>
            <aut:param value="0" name="meanArrival"/>
        </aut:params>
        <aut:events>
            <aut:reference id="Configuration"/>
        </aut:events>
    </aut:process>
    <aut:process handler="it.unipr.ce.dsg.deus.impl.process.PoissonProcess" id="PoissonProcess">
        <aut:params>
            <aut:param value="0" name="meanArrival"/>
        </aut:params>
        <aut:events>
            <aut:reference id="PeerMovement"/>
            <aut:reference id="FirstDiscovery"/>
        </aut:events>
    </aut:process>
    <!-- *** SIMULATION *** (10000=10h 100VT = 6 min )-->
    <aut:engine keyspacesize="10000" seed="123456789" maxvt="10000.0">
        <aut:processes>
 	        <aut:reference id="ConfigurationProcess"/>
            <aut:reference id="LogStatPeriodicProcess"/>
            <!--<aut:reference id="LogMaPeriodicProcess"/> -->
          	<aut:reference id="TrafficEventBirthPoissonProcess"/>
            <aut:reference id="RectangularBirth"/>
        </aut:processes>
    </aut:engine>
</aut:automator>
